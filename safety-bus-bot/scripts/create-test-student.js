import dotenv from 'dotenv';
import { supabase } from '../lib/db.js';

dotenv.config();

async function createTestStudent() {
  console.log('üîß ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö...');
  
  try {
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö
    const { data: student, error: studentError } = await supabase
      .from('students')
      .insert({
        student_id: '66543210',
        student_name: '‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
        grade: '‡∏°.1',
        parent_id: 2 // ‡πÉ‡∏ä‡πâ parent_id ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
      })
      .select()
      .single();
    
    if (studentError) {
      console.error('‚ùå Error creating student:', studentError);
      return;
    }
    
    console.log('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', student);
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á
    const { data: checkStudent, error: checkError } = await supabase
      .from('students')
      .select(`
        student_id, student_name, grade, parent_id,
        parents(parent_name, parent_phone)
      `)
      .eq('student_id', '66543210')
      .single();
    
    if (checkError) {
      console.error('‚ùå Error checking student:', checkError);
      return;
    }
    
    console.log('üîç ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á:', checkStudent);
    
  } catch (error) {
    console.error('‚ùå Error:', error);
  }
}

createTestStudent();